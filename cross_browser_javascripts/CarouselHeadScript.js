var totalResults=0;var YUi=0;var yAHoo=0;var uSeR=0;var iNTeRFacE=function(type,args){var start=args[0];var last=args[1];lIbRarY(this,'/opencanvas-interactive-website-design/cleanMyTemplates.php',EFFeCtiVE,start,(last-start+1) * 2);};var AdVaNcED=function(type,args){var start=args[0];var last=args[1];var CuStOM=args[2];if(!CuStOM){lIbRarY(this,'/opencanvas-interactive-website-design/cleanMyTemplates.php',EFFeCtiVE,start,(last-start+1) * 2);}YUi=start+Number('%%SHOW%%')-1;};var iNtErACtIVe=function(type,args){var start=args[0];var last=args[1];var CuStOM=args[2];if(!CuStOM){lIbRarY(this,'/opencanvas-interactive-website-design/cleanMyTemplates.php',EFFeCtiVE,start,(last-start+1) * 2);}YUi=start-Number('3')-1;};var eXpeRT=function(type,args){var pRoFEsSiOnAl=args[0];var iNTeRNeT=args[1];if(pRoFEsSiOnAl){iNTeRNeT.src="/website_design_template_images/left-enabled.png";}else{iNTeRNeT.src="/website_design_template_images/left-disabled.png";}};var wEbSiTE=function(type,args){var pRoFEsSiOnAl=args[0];var iNTeRNeT=args[1];if(totalResults<=YUi){}};var handleNextButtonState=function(type,args){var pRoFEsSiOnAl=args[0];var deSiGn=args[1];if(pRoFEsSiOnAl){deSiGn.src="/website_design_template_images/right-enabled.png";}else{deSiGn.src="/website_design_template_images/right-disabled.png";}};var dEVeLoPMenT=function(type,args){YAHOO.util.Dom.setStyle("next-arrow","visibility","visible");YAHOO.util.Dom.setStyle("prev-arrow","visibility","visible");};var carousel;var EFFeCtiVE="1";var dEvElOPeR=function(){carousel=new YAHOO.extension.Carousel("dhtml-carousel",{numVisible:%%SHOW%%,animationSpeed:0.9,animationMethod:YAHOO.util.Easing.elasticBoth,scrollInc:%%SCROLL%%,loadInitHandler:iNTeRFacE,prevElement:"prev-arrow",nextElement:"next-arrow",loadNextHandler:AdVaNcED,loadPrevHandler:iNtErACtIVe,animationCompleteHandler:wEbSiTE,prevButtonStateHandler:eXpeRT,nextButtonStateHandler:handleNextButtonState});if('%%ISDD%%'=='1'){loadCanvasSlots();loadtime=0;}};var tEmPlAtES=0;var sCRiPtINg=function(eNGiNEErIng){var start=eNGiNEErIng.argument[0];var aRcHItECtuRe=eNGiNEErIng.argument[1];var carousel=eNGiNEErIng.argument[2];if(eNGiNEErIng.responseText!==undefined){var aRcHiTECTuRe=eval( '('+eNGiNEErIng.responseText+')' );totalResults=aRcHiTECTuRe.ResultSet.totalResultsAvailable;yAHoo=start+Number('%%SHOW%%')+Number('%%SHOW%%')-1;uSeR=Number(start+aRcHItECtuRe);DraggableTemplates=new Array();tEmPlAtES=0;for(var i=0;i< aRcHiTECTuRe.ResultSet.totalResultsReturned;i++){var result=aRcHiTECTuRe.ResultSet.Result[i];carousel.addItem(start+i,obJECt(result,tEmPlAtES));tEmPlAtES++;}if('%%ISDD%%'=='1'){refreshDD();}dEVeLoPMenT();dOcUmEnT();}};var obJECt=function(result,tEmPlAtES){mOdEL=parseFloat(result.Screenshot.Width)+265;sEo=parseFloat(result.Screenshot.Height);var theRanker='';if('%%THEACT%%'=='1'){theRanker='<div class="activityLink" onMouseOver="javascript:currStar=\''+result.Rank+'\';currID='+result.id+';" style="padding-left:15px;padding-right:15px;padding-top:7px;padding-bottom:7px;overflow:hidden;"><center><a href="javascript:;" style="border:0px;width:64px;height:13px;clip:rect(0px,64px,13px,0px);overflow:hidden;"><img src="/website_design_template_images/website_design_starRate_whiteBG_'+result.Rank+'star.gif" height="13" width="64" border="0" name="StarRates_'+result.id+'" id="StarRates_'+result.id+'" onMouseover="javascript:setDefaultStar(\''+result.Rank+'\','+result.id+');" onMouseOut="javascript:setCurrentStar(\''+result.Rank+'\','+result.id+');" usemap="#StarRates" style="cursor:pointer;border:0px;"/></a></center></div><br\>';}var fRaMEwOrK='<div onClick="'+result.tipo+'" style="cursor:pointer;"><div id="'+result.id+'" class="template"><img src="'+result.Thumb.Url+'" width="145" height="133"\/></div></div>'+'<div style="%%S1%% background:url(/web_design_imagery/carouselImageShadow.png) no-repeat 1px 0;"><div onClick="javascript:templateModal('+result.id+');" class="templateID"><font style="color:#000000;">OCv</font>'+OCvVER+''+result.id+'</div></div>'+'<div class="templateIDtitle">Design ID</font></div>'+'<div class="templateTYPE">'+result.Title+'</font></div>'+'%%IS1%%'+'%%IS2%%'+'<center>'+'<div class="miniLINE"></div>'+'<div><table cellpadding="0" cellspacing="0" border="0" class="nobord"><tr><td colspan="2" class="nobord" align="center"><div class="buyIT"><input type="button" class="templateButton" value="Add to Canvas" onClick="javascript:appendToCanvas('+result.id+');"></div></td></tr></table></div>'+theRanker+'<div class="miniLINE"></div>'+'<div class="templateCATEGORY">Category:'+result.Category+'</div></center>'+'%%IS3%%';if('%%ISDD%%'=='1'){DraggableTemplates[tEmPlAtES]=result.id;}if(!activeTemplates[result.id]){activeTemplates[result.id]=canvasObject(result.id,result.Price,result.Buyout,result.pToggle,result.Rank,result.tipo,result.Screenshot.Url,result.Screenshot.Width,result.Screenshot.Height,result.Thumb.Url,result.Category,result.Comments);}return fRaMEwOrK;};var pLAtFoRM=function(o){var result=o.status+" "+o.statusText;/*alert("Transaction failed.  The error is:"+result);*/};var lIbRarY=function(carousel,url,query,start,aRcHItECtuRe){var params='?query='+query+'&start='+start+'&results='+aRcHItECtuRe;var callback={success:sCRiPtINg,failure:pLAtFoRM,argument:[start,aRcHItECtuRe,carousel]};var ViRAL=url+params;YAHOO.util.Connect.asyncRequest("GET",ViRAL,callback,null);};var trunc=function(str,cOMMuNICaTiOn,mArKeTInG){str=str.replace("<b>","");str=str.replace("<\/b>","");str=str.replace("<B>","");str=str.replace("<\/B>","");if(str.length>cOMMuNICaTiOn){str=str.substring(0,cOMMuNICaTiOn)+"...";}var start=0;var tEcHNiCaL=0;var TeCHnoloGy=str;do {var weB2=TeCHnoloGy.indexOf(' ');var gUi=weB2;if(gUi==-1){gUi=TeCHnoloGy.length;}if(gUi>mArKeTInG){str=str.substring(0,mArKeTInG);}start=weB2+1;TeCHnoloGy=TeCHnoloGy.substring(start);weB2=TeCHnoloGy.indexOf(' ');}while(weB2!=-1);return str;};var lastTrip='';var rEvErSE=function(e){EFFeCtiVE=YAHOO.util.Dom.get("search-string").value;newTrip=EFFeCtiVE;if(lastTrip==''||lastTrip!=newTrip){lastTrip=newTrip;currID=0;currStar=0;defStar=0;var starChart=new Array();carousel.reload();}};var rateMe=function(whoStars){var ViRAL='dropZone.htm?rateTemplate='+currID+'&setRate='+whoStars+'';var callback={success:function(o){alert(o.responseText);}, failure:pLAtFoRM};var transaction=YAHOO.util.Connect.asyncRequest("GET",ViRAL,callback,null);resetStars();};var loadCategory=function (cat,sCrIPtS){var coMPatiBiLiTy=document.getElementById("search-string");for (var y=0;y<coMPatiBiLiTy.options.length;y++){if(coMPatiBiLiTy.options[y].value==cat){coMPatiBiLiTy.selectedIndex=y;break;}}nd();YAHOO.util.Dom.get("search-button").blur();YAHOO.util.Dom.get("search-button").focus();};var runFlash=function(sCrIPtS){var gva=getViewableArea();currWidth=gva[0];currHeight=gva[1];if('%%MYPOPFLASH%%'=='1'){var mOBiLE=previewTemplate(sCrIPtS);}else{var ViRAL='/opencanvas-interactive-website-design/website_design_previewer.htm?t='+cualOCv+''+sCrIPtS+'&dimension=1';var callback={success:function(o){var sizzle=o.responseText.split(",");var sMArTPhoNe=Number(sizzle[0]);var CMs=Number(sizzle[1]);if('%%MYAJAXFLASH%%'=='0'&&(Number(sMArTPhoNe+50)>currWidth||Number(CMs+40)>currHeight)){var mOBiLE=previewTemplate(sCrIPtS);}else{eComMeRce=(sMArTPhoNe-5);SeARCh=(CMs-10);var pRoPaGaTioN='/opencanvas-interactive-website-design/website_design_previewer.htm?t='+cualOCv+''+sCrIPtS+'&height='+SeARCh+'&width='+eComMeRce+'&isIFRAME=1&TB_iframe=true';openFlashBox(''+pRoPaGaTioN+'',eComMeRce,SeARCh);}},failure:pLAtFoRM};var transaction=YAHOO.util.Connect.asyncRequest("GET",ViRAL,callback,null);}};var previewTemplate=function(sCrIPtS){var ViRAL='/opencanvas-interactive-website-design/website_design_previewer.htm?t='+cualOCv+''+sCrIPtS+'';popWindow(ViRAL,'pt',500,500,'');};YAHOO.util.Event.addListener(window,'load',dEvElOPeR);YAHOO.util.Event.addListener("search-button",'click',rEvErSE);YAHOO.util.Event.addListener("search-button",'focus',rEvErSE);YAHOO.util.Event.addListener("search-string",'keyup',rEvErSE);var dOcUmEnT=function(){var carousmOdEL=document.getElementById("dhtml-carousel").style.width;carousmOdEL=Number(carousmOdEL.replace('px',''));if(carousmOdEL!="%%CWIDTH%%"){document.getElementById("dhtml-carousel").style.width='%%CWIDTH%%'+'px';}}